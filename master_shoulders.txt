# // Set up procedure
#
# Start at n2t@ids-n2t-prd-2a.n2t.net/shoulders, type make_ezacct and
# follow the instructions.
# NB: no NAAN or other services are permitted to be supplied to Iran.
#
# // Tear down procedure
#
# See https://confluence.ucop.edu/display/DataCite/Transferring+a+client+from+EZID+to+another+provider
#
# // Former assignments
#
# To mark a shoulder as inactive (eg, a non-responsive EZID account holder
# stops paying bills and the account goes into maintenance mode), add the flag
#
#   active: false
#
# Deliberately retired former records (removed or overwritten) may often be
# found in the companion file, former_shoulders.txt.
#
# Default account set up: one DOI shoulder+minter and one ARK shoulder+minter
# NAANs and Prefixes no longer need to be at highest level of an org, eg, a
# campus library can register as a library and not necessarily as the campus
# Add a datacenter name as CDL.X where X is 8 chars max, all uppercase.
#
# // Other flags
#
# Add "is_supershoulder: true" to mark a shoulder that encompasses at
# least one other shoulder, eg, ark:/99999/ encompasses ark:/99999/fk4.
# Add "crossref: true" to make EZID deposit metadata with Crossref.
# Add "prefix_shares_datacenter: true" to mark a shoulder legitimately
# assigned to more than one datacenter.
#
# // Shoulder removal in EZID Admin User Interface
#
# To remove a shoulder from the system, login to the EZID UI as "admin",
# go to the DASHBOARD tab and select the ADMINISTRATION button.  Then
# go to the Groups line/button, look for the group, then visit any users
# the reference the shoulder, untick their shoulder reference and Save,
# Then in the Group, find the shoulders and "move" (up-arrow) them back
# up out of the group (to the available shoulders).
#
# Then remove any shoulder minter with, eg,
#     make_shdr --remove ark:/12345/x8
# (Do that step before this next step.) Finally, come back and
# remove them from this file, install, and reload EZID as usual.
#
# Deleting the shoulder from the shoulder database without first deleting
# references from the EZID admin UI will cause the shoulder database update
# (and all future updates) to be rejected by EZID. Everything will be fine
# again after you complete the first step, but meanwhile tell other alert
# recipients (eg, Greg) that you're working on it.
#
# // To move DOIs between datacenters
#
# 1. Adjust shoulders to use new datacenter
# 2. DataCite moves existing DOIs to new datacenter
# 3. Greg changes "_datacenter" fields of existing DOIs to new datacenter
# 4. Old datacenters can be deleted or repurposed after move prefixes out
#
# Procedures for removing and transferring stuff:
#   https://confluence.ucop.edu/pages/viewpage.action?pageId=185207031
#
# // To remove an entire ezid account
#
# 1. For each shoulder, do: make_shdr --remove <shoulder_name>
# 2. Move all shoulders and datacenter to former_shoulders file.
# 3. Move NAAN entry to ~/naans/former_naans file
# 4. Add NAAN to the end of the last recycle list in ~/naans/former_naans
# 5. Reload EZID.
#
# // To remove a shoulder
#
# If it has a minter, use "make_shdr --remove ...", for example,
#
#    make_shdr --remove ark:/81221/s4; make_shdr --remove doi:10.21221/C2; make_shdr --remove ark:/80357/s3; make_shdr --remove doi:10.20357/D7
#
# Remember to
#     (1) first make_shdr --remove ... to drop minters, _before_ moving
#     (2) each shoulder and datacenter entry to former_shoulders.txt
#
# // When shoulder removal might imply NAAN removal
#
# If the NAAN was never used, move it to the ~/naans/former_naans file and
# add it to the _end_ of the list of NAANs meant for re-cycling.
#
# // To create a Prefix and data center without on an existing account
#
# Create a pseudo-newaccount form (eg, see ezaccts/newacct88) and run
# make_ezacct with "" and - for the ARK parts and ignore the fake ARK
# shoulder entry generated. xxx this is a mess right now
#
# // To obtain a new prefix
#
# In the Fabrica UI at https://doi.datacite.org, login as "CDL", and click
# the Prefixes tab, then on the "% assign prefix" button.
# (This replaces old procedure of sending email to datacite to request a block,
# and replaces need to maintain a stack top and prefix recycling queue.)
#
# // To assign a prefix to a datacenter
#
# In the Fabrica UI at https://doi.datacite.org, login as "CDL", go to the
# "clients" (datacenter) tab, navigate to client/datacenter, then to the
# "Prefixes" tab. Then click "assign prefix".
# (This replaces the old mds.datacite.org way of doing it.)
#
# // Miscellaneous notes
#
# 2017.02.01 removed ark:/13030/q0 (escholarship)
# xxx rename make_shdr refs to "minter make|remove ..." refs
# xxx rename make_ezacct to "shoulder make"
#
# // Generating short shoulder strings
#
# See "first digit convention" in https://ezid.cdlib.org/learn/id_concepts.
#
# Default shoulder selection: pick one letter and one digit (not 0 or 1).
# To pick the DOI shoulder digit, start with last prefix digit.
# To pick the ARK shoulder digit, start with second to last prefix digit.
# To pick letter for both shoulders, start with a non-vowel, non-ell
# letter from the org acronym.  (what if none?)
# Iterate: change digit until first shoulder that doesn't exist -> Done
# ZZZ AVOID digits 0 and 1 in shoulders!

# ======== Add new shoulders after this line ============

# Below is a record of recent make_ezacct and other command invocations
# used to satisfy customer requests. They provider exemplars for some of
# the diversity of requests.
#
# stanford make_ezacct -n 10.21235 - "" - < ezaccts/newacct > out
# dtic     make_ezacct -n 10.21236 d6 "" t3 < ezaccts/newacct > out
# cliodyna make_ezacct -n 10.21237 c7 "" - < ezaccts/newacct > out
# ucsdspra make_ezacct -n 10.21238 s8 "" s3 < ezaccts/newacct > out
# invemar  make_ezacct -n 10.21239 v9 "" m9 < ezaccts/newacct > out
# siue     make_ezacct -n 10.21414 t4 "" d2 < ezaccts/newacct > out
# adaptive make_ezacct -n 10.21417 b7 "" b4 < ezaccts/newacct > out
# ucbgt    make_ezacct -n 10.21418 g8 "" g4 < ezaccts/newacct > out
# usb      make_ezacct -n 10.21419 b9 "" b2 < ezaccts/newacct > out
# remixman naan_rec ... ; make_shdr ark:/44461/r4
# gns      make_ezacct -n 10.21420 g2 "" n4 < ezaccts/newacct > out
# ucsd_ida make_ezacct -n 10.21422 d2 "" d4 < ezaccts/newacct > out
# tamul    make_ezacct -n 10.21423 m2 "" m3 < ezaccts/newacct > out
# eri      make_ezacct -n 10.21424 r4 "" r2 < ezaccts/newacct > out
# ucmfront make_ezacct -n 10.21425 f5 "" - < ezaccts/newacct > out
# ucmbioge make_ezacct -n 10.21426 b6 "" - < ezaccts/newacct > out
# pubpub   make_ezacct -n 10.21428 p8 "" b2 < ezaccts/newacct > out
# nccw     make_ezacct -n 10.21429 c9 "" s2 < ezaccts/newacct > out
# upennlib make_ezacct 10.21431 p4 "" p3 < ezaccts/newacct > out
# kgrid    naans/forge/naan_rec DLHSDLKS https://lhs.medicine.umich.edu/division-learning-knowledge-systems "University of Michigan Medical School Dept of Learning Health Sciences Div of Learning and Knowledge Systems" Allen Flynn ajflynn@med.umich.edu "+1 734-615-0839" "300 North Ingalls Street, 11th Floor, Suite 1161"
#          then constructed shoulder from new_naa file
#          then did: make_shdr ark:/67034/k4
# nds      make_ezacct 10.21970 n9 "" n7 < ezaccts/newacct > out
# sb-ayliu make_ezacct 10.21972 g2 "" g7 < ezaccts/newacct > out
# ucnrs    make_ezacct 10.21973 n3 "" r7 < ezaccts/newacct > out
# vcu      make_ezacct 10.21974 v4 "" c9 < ezaccts/newacct > out
# ucsdlib  make_ezacct 10.21975 h5 - - < ezaccts/newacct > out
# caspo    make_ezacct 10.21976 c6 "" p7 < ezaccts/newacct > out
# uci      make_ezacct -n 10.21977 d9 - - < ezaccts/newacct > out
# ucla-pds make_ezacct -n 10.21978 p8 - - < ezaccts/newacct > out
# uci-jetem   make_ezacct -n 10.21980 j8 - -  < ezaccts/newacct > out
# uiowa       make_ezacct -n 10.21981 m8 "" w9  < ezaccts/newacct > out
# nu-lib      make_ezacct -n 10.21985 n2 "" n2  < ezaccts/newacct > out
# sdsc-caida  make_ezacct -n 10.21986 s6 "" s6  < ezaccts/newacct > out
# iris        make_ezacct -n 10.21987 r7 "" r7  < ezaccts/newacct > out
# unlvezid naans/forge/naan_rec UNLV http://www.library.unlv.edu "University of Nevada, Las Vegas University Libraries" Cyndi Shein cyndi.shein@unlv.edu "+1 702-895-2209" "4505 S. Maryland Parkway  Box 457001  Las Vegas, NV  89154-7001"
# ucla_ceegeo make_ezacct -n 10.21222 c2 "" c2  < ezaccts/newacct > out
# guassian    make_ezacct -n 10.21988 g8 "" g8  < ezaccts/newacct > out
# dartmouth   make_ezacct -n 10.21989 d9 - -  < ezaccts/newacct > out
# lbnl acdo   make_ezacct -n 10.21990 b9 - -  < ezaccts/newacct > out
# ualberta    make_shdr doi:10.21991/C9; make_shdr doi:10.21992/T9; valsh doi:10.21991/C9 doi:10.21992/T9
# cu-mill     make_ezacct -n 10.7916 c6 - -  < ezaccts/newacct > out
# blavatnik   make_ezacct -n - - 86084 b4 < ezaccts/newacct > out
#      ***    RECYCLING ark:/86084 (Digital Science)
# oclcmrd     make_ezacct -n 10.25333 c3 83018 c8  < ezaccts/newacct > out
# lbnl crd    make_ezacct -n 10.21990 r2 - -  < ezaccts/newacct > out
# msulib      make_ezacct -n 10.25335 m5 "" m5 < ezaccts/newacct > out
# caltech_arc make_ezacct -n - - 77914 c4 < ezaccts/newacct > out
#      ***    RECYCLING ark:/77914 (St. Edward's University)
# ucsd_ndex   make_ezacct -n 10.18119 n9 - -  < ezaccts/newacct > out
# ucpress     make_ezacct -n 10.17916 p6 - -  < ezaccts/newacct > out
# aublib      make_ezacct -n - - 86073 b3 < ezaccts/newacct > out
# ucm_libda   make_ezacct -n - - 86071 d2 < ezaccts/newacct > out
# sb-zapwld   make_ezacct -n 10.21431 z3 86074 z4 < ezaccts/newacct > out
# iastate_lib make_ezacct -n - - 87292 w9 < ezaccts/newacct > out
# lbnl-lib    make_ezacct -n 10.25342 - - -  < ezaccts/newacct > out
# ucsdlib     make_ezacct -n 10.21221 s2 - -  < ezaccts/newacct > out
# lbnl-lib    make_ezacct -n 10.20357 b7 51986 b6  < ezaccts/newacct > out
# ucd-library make_ezacct -n 10.18439 s9 87287 d7  < ezaccts/newacct > out
# dartmouthc  make_ezacct -n - - 81428 v8  < ezaccts/newacct > out
# punctumbook make_ezacct -n 10.21983 p3 84135 p5  < ezaccts/newacct > out
# visiblethk  make_ezacct -n - - 88737 t7 < ezaccts/newacct > out
# unlvezid    make_ezacct -n - - 62930 w1 < ezaccts/newacct > out
#             which fails because naan 62930 already exists
# dcppc       make_ezacct -n - - 13030 d3 < ezaccts/newacct > out
#             which fails because naan 13030 already exists
# uci_pece    make_ezacct -n 10.21416 p6 81416 p4  < ezaccts/newacct > out
# lbnl-gasnet make_ezacct -n 10.25344 s4 - -  < ezaccts/newacct > out
# ucsd_ccms   make_ezacct -n 10.25345 c5 80359 c9  < ezaccts/newacct > out
# sb-eschol   nog -p /apps/n2t/sv/cur/apache2/minters/ezid/ark mkminter --type rand --atlast add3 b5070/h9 eedk
# ??? wouldn't make_shdr -p have sufficed?
# tamu_ezid   nog -p /apps/n2t/sv/cur/apache2/minters/ezid/ark mkminter --type rand --atlast add3 81423/g1 eedk
# tamu_ezid   nog -p /apps/n2t/sv/cur/apache2/minters/ezid/ark mkminter --type rand --atlast add3 81423/d2 eedk
# ucla-dverse make_ezacct -n 10.25346 s6 87610 s7  < ezaccts/newacct > out
# ucd-legacy  make_ezacct -n 10.25347 d7 85781 m7  < ezaccts/newacct > out
# dohanian    make_ezacct -n 10.25348 h8 - -  < ezaccts/newacct > out
# achiii      make_ezacct -n - - 87296 s6 < ezaccts/newacct > out
# ucsbdash    make_ezacct -n 10.25349 d9 - -  < ezaccts/newacct > out
# hearstmsm   make_ezacct -n - - 21549 -  < ezaccts/newacct > out
# wouldn't make_shdr have worked?
# scolomfr    nog -p /apps/n2t/sv/cur/apache2/minters/ezid/ark mkminter --type rand --atlast add3 19153/s9 eedk
# ucb-library make_ezacct -n 10.25350 b5 28722 b8  < ezaccts/newacct > out
# uci chem    make_ezacct -n 10.25351 v3 - - < ezaccts/newacct > out
# uci-eschol  make_shdr doi:10.5070/T3
# ucsb-eschol make_shdr doi:10.5070/T2
# ucd-library make_ezacct -n - - 87293 d3 < ezaccts/newacct > out
# ucb-eschol  make_shdr doi:10.5070/BP3
# sb-eschol   make_shdr doi:10.5070/D6
# cdl general make_ezacct -n 10.17602 c2 - - < ezaccts/newacct > out
# dash-ucop   make_shdr -v doi:10.18737/D7
# cdl general make_ezacct -n - - 81983 s9 < ezaccts/newacct > out
# hearstmsm   make_ezacct -n 10.21428 - - - < ezaccts/newacct > out
# uci-exoner  make_ezacct -n - - 88112 x2 < ezaccts/newacct > out
# ucla        make_ezacct -n 10.15144 s4 - - < ezaccts/newacct > out
# ucidigasset make_ezacct -n 10.15145 d5 81235 d8 < ezaccts/newacct > out
# ucla_its    make_ezacct -n 10.17610 t6 - - < ezaccts/newacct > out
# ./form2shoulder request

:: ark:/68061/xt3
type: shoulder
manager: ezid
#eziduser: ncpt
name: Incipit Ark
minter: https://ids-n2t2-stg.n2t.net/a/ncpt/m/ark/68061/xt3

# :: ark:/99999/fk8
# type: shoulder
# manager: ezid
# eziduser: apitest
# name: ARK Test (non-expiring)
# date: 2013.07.16
# minter: https://ids-n2t2-stg.n2t.net/a/ncpt/m/ark/99999/fk8

:: ark:/99999/fk3
type: shoulder
manager: ezid
#eziduser: ncpt
name: Incipit Test ARK
minter: https://ids-n2t2-stg.n2t.net/a/ncpt/m/ark/99999/fk3

#:: ark:/99999/968061_bb4
#type: shoulder
#manager: ezid
#eziduser: incipit
#name: Incipit Ark
#minter: https://ids-n2t2-stg.n2t.net/a/ncpt/m/ark/99999/968061_bb4
